{% extends "base.html" %} {% block title %}대시보드{% endblock %} {% block
content %}
<h1>대시보드</h1>
<p>환영합니다, {{ user.username }}님!</p>

<div class="search-container">
  <form method="GET" action="{{ url_for('dashboard') }}" class="search-form">
    <input
      type="text"
      name="q"
      placeholder="상품 검색..."
      value="{{ search_query or '' }}"
      class="search-input"
    />
    <button type="submit" class="search-button">검색</button>
  </form>
</div>

<div class="products-container">
  {% if products %}
  <h2>상품 목록</h2>
  <ul class="product-list">
    {% for product in products %}
    <li class="product-item">
      <h3>
        <a href="{{ url_for('view_product', product_id=product.id) }}"
          >{{ product.title }}</a
        >
      </h3>
      <p class="price">{{ product.price }}원</p>
      <p class="description">{{ product.description }}</p>
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <p>등록된 상품이 없습니다.</p>
  {% endif %}
</div>

<p><a href="{{ url_for('new_product') }}">새 상품 등록</a></p>

<h3>실시간 채팅</h3>
<div id="chat">
  <ul id="messages"></ul>
  <input id="chat_input" type="text" placeholder="메시지를 입력하세요" />
  <button onclick="sendMessage()">전송</button>
</div>

<script type="text/javascript">
  var socket = io();
  socket.on("connect", function () {
    console.log("채팅 서버에 연결됨");
  });
  socket.on("message", function (data) {
    var messages = document.getElementById("messages");
    var item = document.createElement("li");
    item.textContent = data.username + ": " + data.message;
    messages.appendChild(item);
    window.scrollTo(0, document.body.scrollHeight);
  });
  function sendMessage() {
    var input = document.getElementById("chat_input");
    var message = input.value;
    if (message) {
      socket.emit("send_message", {
        username: "{{ user.username }}",
        message: message,
      });
      input.value = "";
    }
  }
</script>

<style>
  .search-container {
    margin: 20px 0;
    padding: 15px;
    background-color: #f8f9fa;
    border-radius: 8px;
    width: 100%;
    box-sizing: border-box;
  }

  .search-form {
    display: flex;
    gap: 8px;
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
    align-items: center;
  }

  .search-input {
    flex: 1 1 auto;
    min-width: 200px;
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    height: 36px;
    box-sizing: border-box;
    font-size: 16px;
  }

  .search-button {
    flex: 0 0 60px;
    height: 36px;
    line-height: 36px;
    padding: 0;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    white-space: nowrap;
    cursor: pointer;
    font-size: 14px;
  }

  .search-button:hover {
    background-color: #0056b3;
  }
  .product-list {
    list-style: none;
    padding: 0;
  }

  .product-item {
    padding: 20px;
    margin-bottom: 20px;
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .product-item h3 {
    margin: 0 0 10px 0;
  }

  .product-item .price {
    color: #28a745;
    font-weight: bold;
    margin: 10px 0;
  }

  .product-item .description {
    color: #666;
  }
</style>
{% endblock %}
